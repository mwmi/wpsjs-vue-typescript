<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YRDå·¥å…·é¢æ¿</title>
    <link rel="stylesheet" href="../css/ui.css">
    <link rel="stylesheet" href="../css/table.css">
    <script type="text/javascript" src="../js/util.js"></script>
    <script type="text/javascript" src="../js/table.js"></script>
    <script type="text/javascript" src="../.debugTemp/wpsjsrpcsdk.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", "å®‹ä½“", "SimSun", "Helvetica", "Arial", sans-serif;
        }

        :root {
            /* ä¸»é¢˜è‰² */
            --primary: #020617;
            --primary-hover: #1e293b;
            --primary-light: #f1f5f9;

            /* è¾¹æ¡†è‰² */
            --border: #cbd5e1;
            --border-light: #e2e8f0;

            /* èƒŒæ™¯è‰² */
            --bg-body: #f8fafc;
            --bg-card: #ffffff;
            --bg-light: #f8fafc;
            --bg-hover: #f1f5f9;
            --bg-tag: #f1f5f9;
            --bg-selected: #e0e0e0;

            /* æ–‡æœ¬è‰² */
            --text-primary: #1e293b;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --text-dark: #0f172a;
            --text-on-primary: #ffffff;

            /* åœ†è§’ */
            --radius-sm: 6px;
            --radius-md: 6px;
            --radius-lg: 8px;
            --radius-xl: 12px;
            --radius-full: 9999px;

            /* é˜´å½± */
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.05);
            --shadow-primary: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
            --shadow-primary-hover: 0 6px 10px -1px rgba(0, 0, 0, 0.4);
            --shadow-tooltip: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
            --shadow-modal: 0 20px 25px -5px rgba(0, 0, 0, 0.2), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
            --shadow-toast: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -4px rgba(0, 0, 0, 0.1);

            /* è¿‡æ¸¡ */
            --transition: 0.2s ease;

            /* é—´è·ï¼ˆå·²è½¬æ¢ä¸º pxï¼‰ */
            --gap-sm: 8px;
            --gap-md: 12px;
            --gap-lg: 16px;
            --gap-xl: 24px;
        }

        body {
            display: flex;
            justify-content: center;
            background: var(--bg-body);
            color: var(--text-primary);
        }

        /* WebKit å†…æ ¸ */
        html::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        html::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        html::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

        html::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* ----- å¡ç‰‡ä¸»ä½“ ----- */
        .card {
            width: 100%;
            max-width: 1400px;
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: var(--gap-xl);
            box-shadow: var(--shadow-md);
            transition: box-shadow var(--transition);
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
        }

        /* ----- é€‰é¡¹å¡ ----- */
        .tabs {
            display: flex;
            gap: 32px;
            border-bottom: 1px solid var(--border-light);
            padding-bottom: 8px;
            margin-bottom: var(--gap-xl);
        }

        .tab {
            font-size: 16px;
            font-weight: 600;
            padding: 12px 4px 16px 4px;
            color: var(--text-muted);
            border-bottom: 2px solid transparent;
            transition: all var(--transition);
            cursor: pointer;
            position: relative;
        }

        .tab svg {
            vertical-align: middle;
            margin-right: 8px;
        }

        .tab::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary);
            transition: width var(--transition);
        }

        .tab.active {
            color: var(--primary);
        }

        .tab.active::after {
            width: 100%;
        }

        .tab:not(.active):hover {
            color: #334155;
        }

        /* ----- åŒæ ç½‘æ ¼ ----- */
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--gap-lg);
        }

        @media (max-width: 1500px) {
            .grid-2 {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .card {
                padding: 0 15px;
            }
        }

        /* ----- åˆ†ç»„å¡ç‰‡ ----- */
        .group {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-light);
            padding: 20px;
        }

        .group-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .group-title span {
            background: var(--bg-tag);
            padding: 4px 12px;
            border-radius: var(--radius-full);
            font-size: 14px;
            color: #334155;
            margin-left: 12px;
        }

        .group-pair {
            display: flex;
            flex-wrap: wrap;
            gap: var(--gap-md);
            width: 100%;
        }

        .group-pair .group {
            flex: 1 1 calc(50% - 6px);
            min-width: 140px;
        }

        .subgroup {
            margin-bottom: var(--gap-xl);
        }

        .subgroup-header {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 16px;
            border-left: 3px solid var(--primary);
            padding-left: 12px;
        }

        /* ----- å•é€‰ã€æ»‘å—ã€é¢œè‰²å—ç­‰ ----- */
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: var(--gap-md);
            margin-bottom: 16px;
        }

        .radio-item {
            display: flex;
            align-items: center;
            font-size: 14px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.15s;
            border-radius: var(--radius-sm);
            padding: 4px 8px;
        }

        .radio-item:hover {
            color: var(--primary);
            background: rgba(0, 0, 0, 0.03);
        }

        input[type="radio"] {
            accent-color: var(--primary);
            width: 16px;
            height: 16px;
            margin-right: 12px;
            transition: 0.15s;
            cursor: pointer;
        }

        input[type="radio"]:hover {
            transform: scale(1.1);
            filter: drop-shadow(0 0 3px rgba(0, 0, 0, 0.4));
        }

        .color-row {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px 24px;
            background: var(--bg-light);
            padding: 12px 16px;
            border-radius: var(--radius-lg);
            margin: 12px 0 16px 0;
            transition: var(--transition);
        }

        .color-row:hover {
            background: var(--bg-hover);
        }

        .color-block {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .color-label {
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .swatch {
            width: 24px;
            height: 24px;
            background: #2d3138;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            transition: var(--transition);
            cursor: pointer;
        }

        .swatch:hover {
            transform: scale(1.1);
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.2);
        }

        .transparency {
            display: flex;
            align-items: center;
            gap: var(--gap-md);
            flex-wrap: wrap;
        }

        input[type="range"] {
            width: 150px;
            height: 6px;
            background: var(--border-light);
            border-radius: var(--radius-full);
            -webkit-appearance: none;
            appearance: none;
            transition: background var(--transition);
        }

        input[type="range"]:hover {
            background: var(--border);
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: white;
            border: 2px solid var(--primary);
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: 0.15s;
            cursor: pointer;
        }

        input[type="range"]:hover::-webkit-slider-thumb {
            transform: scale(1.15);
            background: #f5f5f5;
            box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.08);
        }

        .percent {
            font-size: 12px;
            background: var(--bg-tag);
            padding: 4px 12px;
            border-radius: var(--radius-full);
            color: var(--text-primary);
            font-weight: 500;
            min-width: 48px;
            text-align: center;
        }

        /* ----- æ•°å­—è¾“å…¥æ§ä»¶ ----- */
        .input-number {
            display: inline-flex;
            align-items: stretch;
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            background: white;
            transition: var(--transition);
            overflow: hidden;
        }

        .input-number:hover,
        .input-number:focus-within {
            border-color: var(--primary);
        }

        .input-number:focus-within {
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.2);
        }

        .input-number input {
            width: 70px;
            padding: 8px 0 8px 12px;
            border: none;
            font-size: 14px;
            font-weight: 500;
            background: transparent;
            outline: none;
            text-align: left;
        }

        .input-number-controls {
            display: flex;
            flex-direction: column;
            border-left: 1px solid var(--border-light);
            background: var(--bg-light);
        }

        .input-number-controls button {
            background: white;
            border: none;
            width: 24px;
            height: 24px;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            cursor: pointer;
            transition: 0.1s;
            line-height: 1;
            flex: 1;
        }

        .input-number-controls button:first-child {
            border-bottom: 1px solid var(--border-light);
        }

        .input-number-controls button:hover {
            background: var(--primary);
            color: white;
        }

        .field {
            display: flex;
            align-items: center;
            gap: 8px 12px;
            flex-wrap: wrap;
        }

        .field label {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 450;
        }

        input[type="number"].normal-number {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            font-size: 16px;
            font-weight: 500;
            transition: var(--transition);
        }

        input[type="number"].normal-number:hover,
        input[type="number"].normal-number:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.2);
            outline: none;
        }

        /* ----- åŸç”Ÿä¸‹æ‹‰æ¡†å¢å¼º ----- */
        select {
            padding: 8px 32px 8px 16px;
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            font-size: 16px;
            background-color: white;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="%23475569" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>');
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 16px;
            -webkit-appearance: none;
            appearance: none;
            transition: var(--transition);
            cursor: pointer;
            color: var(--text-primary);
            font-weight: 450;
            min-width: 120px;
        }

        select:hover {
            border-color: var(--primary);
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="%23020617" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>');
            background-color: var(--primary-light);
        }

        select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.2);
            outline: none;
        }

        /* ----- è‡ªå®šä¹‰ä¸‹æ‹‰æ¡† ----- */
        .custom-select {
            position: relative;
            display: inline-block;
            width: 180px;
        }

        .custom-select-button {
            background: white;
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            padding: 8px 16px;
            font-size: 16px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            transition: var(--transition);
        }

        .custom-select-button:hover {
            border-color: var(--primary);
        }

        .custom-select-dropdown {
            position: absolute;
            top: calc(100% + 4px);
            left: 0;
            width: 100%;
            background: white;
            border: 1px solid var(--border-light);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            padding: 4px;
            z-index: 200;
            display: none;
        }

        .custom-select-dropdown.show {
            display: block;
        }

        .custom-select-option {
            padding: 8px 16px;
            border-radius: var(--radius-sm);
            font-size: 16px;
            color: var(--text-primary);
            cursor: pointer;
            transition: background 0.15s;
        }

        .custom-select-option:hover {
            background: #f5f5f5;
            color: var(--primary);
        }

        .custom-select-option.selected {
            background: var(--bg-selected);
            color: var(--primary);
            font-weight: 500;
        }

        /* ----- æŒ‰é’® ----- */
        .button-group {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            row-gap: var(--gap-sm);
            column-gap: 1%;
        }

        .btn {
            padding: 8px 16px;
            border-radius: var(--radius-md);
            font-size: 14px;
            font-weight: 500;
            background: white;
            border: 1px solid var(--border);
            color: var(--text-primary);
            transition: all var(--transition);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            box-shadow: var(--shadow-sm);
        }

        .btn-primary {
            background: var(--primary);
            border-color: var(--primary);
            color: var(--text-on-primary);
            box-shadow: var(--shadow-primary);
        }

        .btn-primary:hover {
            background: var(--primary-hover);
            border-color: var(--primary-hover);
            transform: translateY(-1px);
            box-shadow: var(--shadow-primary-hover);
        }

        .btn-secondary:hover {
            background: var(--primary-light);
            border-color: var(--primary);
            color: var(--primary);
            transform: translateY(-1px);
        }

        .btn-text {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-right: 4px;
            white-space: nowrap;
            line-height: 1;
            align-self: center;
        }

        .btn-block {
            width: 100%;
            justify-content: center;
        }

        /* æŒ‰é’®ç»„å†…çš„åˆ†å‰²çº¿ */
        .button-group .divider,
        .vertical-buttons .divider {
            height: 1px;
            background: var(--border-light);
            margin: var(--gap-sm) 0;
            width: 100%;
        }

        .vertical-buttons {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: var(--gap-sm);
        }

        .vertical-buttons .btn {
            width: 100%;
        }

        /* å†…è”æŒ‰é’®ç»„ï¼šæ— ç¼æ‹¼æ¥ */
        .button-group-inline {
            display: flex;
            gap: 0;
            width: 100%;
        }

        .button-group-inline .btn {
            border-radius: 0;
            margin: 0;
            padding: 8px 16px;
            flex: 1;
        }

        .button-group-inline .btn:first-child {
            border-top-left-radius: var(--radius-md);
            border-bottom-left-radius: var(--radius-md);
        }

        .button-group-inline .btn:last-child {
            border-top-right-radius: var(--radius-md);
            border-bottom-right-radius: var(--radius-md);
        }

        .button-group-inline .btn:hover {
            background: var(--primary-light);
            border-color: var(--primary);
            color: var(--primary);
        }

        /* å¯ç¼–è¾‘æ•°å€¼æ§ä»¶ */
        .editable-stepper {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 6px 0;
            width: 100%;
        }

        .stepper-btn {
            width: 20%;
            height: 32px;
            border: 1px solid var(--border);
            background: white;
            font-size: 16px;
            font-weight: bold;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.15s;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            flex-shrink: 0;
        }

        .stepper-btn:hover {
            background: var(--primary-light);
            border-color: var(--primary);
            color: var(--primary);
        }

        .stepper-input {
            width: 60%;
            height: 32px;
            padding: 6px 8px;
            border: 1px solid var(--border);
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
            text-align: center;
            outline: none;
        }

        .stepper-input::-webkit-outer-spin-button,
        .stepper-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            appearance: none;
        }

        .stepper-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.2);
        }

        .editable-stepper .stepper-btn:first-of-type {
            border-top-left-radius: var(--radius-md);
            border-bottom-left-radius: var(--radius-md);
        }

        .editable-stepper .stepper-btn:last-of-type {
            border-bottom-right-radius: var(--radius-md);
            border-top-right-radius: var(--radius-md);
        }

        /* ----- Tooltip ----- */
        span[data-tooltip] {
            padding: 4px;
            font-weight: 600;
        }

        .global-tooltip {
            position: fixed;
            background: var(--primary);
            color: white;
            font-size: 12.8px;
            padding: 8px 12px;
            border-radius: var(--radius-sm);
            white-space: nowrap;
            box-shadow: var(--shadow-tooltip);
            pointer-events: none;
            z-index: 10000;
            opacity: 0;
            transform: scale(0.9);
            transition: opacity var(--transition), transform var(--transition);
            transform-origin: center bottom;
            display: none;
            --arrow-left: 50%;
        }

        .global-tooltip.show {
            display: block;
            opacity: 1;
            transform: scale(1);
        }

        .global-tooltip::before {
            content: '';
            position: absolute;
            left: var(--arrow-left);
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-bottom-color: var(--primary);
            top: -12px;
        }

        .global-tooltip.tooltip-above::before {
            border-bottom-color: transparent;
            border-top-color: var(--primary);
            top: auto;
            bottom: -12px;
        }

        .global-tooltip.tooltip-above {
            transform-origin: center top;
        }

        /* ----- åˆ†æ®µæ§ä»¶ ----- */
        .segmented {
            display: flex;
            background: var(--bg-tag);
            border-radius: 10px;
            padding: 4px;
            gap: 4px;
        }

        .segment-item {
            padding: 6px 20px;
            font-size: 12px;
            border-radius: var(--radius-md);
            background: transparent;
            color: var(--text-secondary);
            transition: var(--transition);
            cursor: pointer;
            font-weight: 500;
            border: none;
        }

        .segment-item.active {
            background: white;
            color: var(--primary);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        /* ----- æ¶ˆæ¯å®¹å™¨ ----- */
        .message-container {
            position: fixed;
            top: 16px;
            right: 16px;
            display: flex;
            flex-direction: column;
            gap: var(--gap-sm);
            z-index: 10000;
            pointer-events: none;
            max-width: 380px;
            width: auto;
            align-items: flex-end;
        }

        .message-toast {
            background: white;
            padding: 12px 16px;
            border-radius: 10px;
            box-shadow: var(--shadow-toast);
            display: flex;
            align-items: center;
            gap: var(--gap-md);
            font-size: 14px;
            font-weight: 500;
            animation: slideIn 0.25s;
            width: fit-content;
            max-width: 100%;
            pointer-events: auto;
            transition: opacity 0.25s, transform 0.25s;
        }

        .message-toast.hide {
            opacity: 0;
            transform: translateX(30px);
        }

        @keyframes slideIn {
            from {
                transform: translateX(380px);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* ----- æ¨¡æ€æ¡† ----- */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 20000;
            visibility: hidden;
            opacity: 0;
            transition: opacity var(--transition), visibility var(--transition);
        }

        .modal-overlay.show {
            visibility: visible;
            opacity: 1;
        }

        .modal-box {
            background: white;
            width: 400px;
            max-width: 90%;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-modal);
            padding: var(--gap-xl);
            transform: scale(0.95);
            transition: transform 0.2s ease-out;
        }

        .modal-overlay.show .modal-box {
            transform: scale(1);
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 12px;
        }

        .modal-content {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: var(--gap-xl);
            line-height: 1.5;
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 16px;
        }

        /* ----- ç­‰å¾…æ•ˆæœ ----- */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 30000;
            visibility: hidden;
            opacity: 0;
            transition: opacity var(--transition), visibility var(--transition);
        }

        .loading-overlay.show {
            visibility: visible;
            opacity: 1;
        }

        .loading-spinner {
            background: white;
            padding: 24px 32px;
            border-radius: 24px;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 16px;
            font-size: 16px;
            font-weight: 500;
            color: var(--primary);
        }

        .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid var(--border-light);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* ----- é¢æ¿åˆ‡æ¢éšè— ----- */
        .panel.hidden {
            display: none;
        }

        /* ----- å¤šé€‰æ¡†åˆ—è¡¨ç­‰ ----- */
        .list-section {
            margin-top: var(--gap-xl);
            display: flex;
            flex-direction: column;
            gap: var(--gap-xl);
        }

        .select-list {
            display: flex;
            flex-direction: column;
            gap: var(--gap-sm);
        }

        select[multiple] {
            width: 100%;
            padding: 12px;
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
            background: white;
            transition: var(--transition);
        }

        select[multiple]:hover,
        select[multiple]:focus {
            border-color: var(--primary);
        }

        select[multiple]:focus {
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.2);
            outline: none;
        }

        select[multiple] option {
            padding: 8px 16px;
            border-radius: var(--radius-sm);
            margin: 4px 0;
        }

        .divider {
            height: 1px;
            background: var(--border-light);
            margin: 24px 0 12px;
        }

        .group-pair .table-container {
            overflow-x: auto;
            width: 100%;
        }

        .btn-export {
            width: 48%;
        }

        .tab::before {
            content: "";
            display: inline-block;
            width: 1em;
            height: 1em;
            background-image: url('../images/å¼€å•.svg');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            vertical-align: -0.15em;
            margin-right: 6px;
        }
    </style>
</head>

<body>
    <!-- æ¶ˆæ¯å †å å®¹å™¨ï¼ˆå›ºå®šæœ€å³ç«¯ï¼Œå³å¯¹é½ï¼‰ -->
    <div id="messageContainer" class="message-container"></div>

    <!-- æ¨¡æ€ç¡®è®¤æ¡† -->
    <div id="modalConfirm" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title">ç¡®è®¤æ“ä½œ</div>
            <div class="modal-content" id="modalMessage">æ‚¨ç¡®å®šè¦æ‰§è¡Œæ­¤æ“ä½œå—ï¼Ÿ</div>
            <div class="modal-actions">
                <button id="modalCancel" class="btn">å–æ¶ˆ</button>
                <button id="modalOk" class="btn btn-primary">ç¡®å®š</button>
            </div>
        </div>
    </div>

    <!-- ç­‰å¾…åŠ è½½æ•ˆæœ -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <span>å¤„ç†ä¸­ï¼Œè¯·ç¨å€™...</span>
        </div>
    </div>
    <div class="card">
        <!-- é€‰é¡¹å¡ -->
        <div class="tabs" id="tabHeaders">
            <div class="tab active" data-panel="kaidanPanel">å¼€å•</div>
        </div>

        <div class="panel-container">
            <!-- å½¢çŠ¶é€‰é¡¹é¢æ¿ -->
            <div id="kaidanPanel" class="panel">
                <div class="grid-2">
                    <!-- å·¦åˆ—ï¼šå¡«å……ä¸çº¿æ¡ -->
                    <div class="group-pair">
                        <div class="group">
                            <div class="subgroup-header">âš™ï¸ æ ¼å¼è®¾ç½®</div>
                            <div class="button-group vertical-buttons">
                                <button data-tooltip="æ ¼å¼åŒ–é¡µé¢" class="btn btn-primary" id="btnApply">ğŸ“æ ¼å¼åŒ–</button>
                                <button class="btn btn-secondary" id="btnCancel">âœï¸ä¹˜å·æ›¿æ¢</button>
                                <button class="btn btn-secondary" id="btnShowSelect">âœï¸æ’å…¥æ‹¬å·</button>
                                <button class="btn btn-secondary" id="btnLoading">âœï¸ç›´å¾„ç¬¦å·</button>
                                <!-- å¯ç¼–è¾‘æ•°å€¼æ§ä»¶ -->
                                <div class="editable-stepper">
                                    <span class="btn-text" data-tooltip="è®¾ç½®å•å…ƒæ ¼é¦–è¡Œç¼©è¿›é•¿åº¦"
                                        style="border-bottom:1px dashed #056de8;margin-right: 8px;">ç¼©è¿›</span>
                                    <button class="stepper-btn minus">âˆ’</button>
                                    <input type="number" class="stepper-input" value="0" min="0" max="10" step="1">
                                    <button class="stepper-btn plus">+</button>
                                </div>
                            </div>
                        </div>
                        <div class="group">
                            <div class="subgroup-header">ğŸªŸ è¡¨æ ¼æ“ä½œ</div>
                            <div class="button-group vertical-buttons">
                                <button class="btn btn-primary" id="btnApply">ğŸ“„æ–°å»ºè¡¨æ ¼</button>
                                <button class="btn btn-secondary" id="btnCancel">ğŸ—‘ï¸æ¸…é™¤å†…å®¹</button>
                                <button class="btn btn-secondary" id="btnDelete">âŒåˆ é™¤è¡¨æ ¼</button>
                                <div class="divider"></div>
                                <button class="btn btn-secondary" id="btnDelete">è‡ªé€‚åº”æ–‡æœ¬</button>
                                <button class="btn btn-secondary" id="btnDelete">æ¨èå­—ä½“</button>
                            </div>
                        </div>
                    </div>
                    <div class="group">
                        <div class="subgroup-header">ğŸ“ƒ PDFå¯¼å‡º</div>
                        <div class="button-group">
                            <button class="btn btn-primary btn-export" id="btnPDFExport">å¯¼å‡ºPDF</button>
                            <button class="btn btn-secondary btn-export" id="btnPDFDelete">åˆ é™¤PDF</button>
                            <div class="group-pair">
                                <span class="btn-text" data-tooltip="ç‚¹å‡»ä¸‹åˆ—æŒ‰é’®ç”Ÿæˆå¯¹åº”pdf"
                                    style="border-bottom:1px dashed #056de8;">ğŸ“š PDFæ–‡æ¡£ç”Ÿæˆ</span>
                                <div class="button-group-inline">
                                    <button class="btn btn-secondary" id="btnGenerate3">ä¸‰è”</button>
                                    <button class="btn btn-secondary" id="btnGenerate2">äºŒè”</button>
                                    <button class="btn btn-secondary" id="btnGenerate1">ä¸€è”</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="group-pair">
                        <div class="group">
                            <div class="subgroup-header">ğŸ“• å¯¼å‡ºé¢„è§ˆ</div>
                            <div class="button-group vertical-buttons">
                                <button class="btn btn-primary" id="btnReadFiles">ğŸ·ï¸åˆ·æ–°åˆ—è¡¨</button>
                                <div class="table-container" id="readfileTable"></div>
                                <div class="table-container" id="readOutputTable"></div>
                            </div>
                        </div>
                        <div class="group">
                            <div class="subgroup-header">ğŸ“‚ å¼€å•æ–‡æ¡£</div>
                            <div class="button-group vertical-buttons">
                                <button class="btn btn-primary" id="btnApply">ğŸ“æ·»åŠ æ–‡æ¡£</button>
                                <div class="table-container" id="openfileTable"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
    <script type="text/javascript" src="../js/ui.js"></script>
    <script type="text/javascript" src="../js/taskpane.js"></script>
    <script>
        (function () {
            "use strict";

            // ---------- ç­‰å¾… DOM åŠ è½½å®Œæˆ ----------
            function init() {
                // ---------- å…¨å±€æ¶ˆæ¯æç¤ºï¼ˆå †å  + æ¶ˆå¤±åŠ¨ç”»ï¼‰----------
                const messageContainer = document.getElementById('messageContainer');
                function showMessage(text, type = 'info') {
                    const toast = document.createElement('div');
                    toast.className = 'message-toast';
                    let icon, bgColor;
                    switch (type) {
                        case 'success': icon = 'âœ…'; bgColor = '#f0faf0'; break;
                        case 'error': icon = 'âŒ'; bgColor = '#fff5f5'; break;
                        case 'warning': icon = 'âš ï¸'; bgColor = '#fff8e7'; break;
                        default: icon = 'â„¹ï¸'; bgColor = '#f1f7ff';
                    }
                    toast.style.background = bgColor;
                    toast.innerHTML = `<span style="font-size:1.2rem;">${icon}</span><span>${text}</span>`;
                    messageContainer.appendChild(toast);
                    setTimeout(() => {
                        toast.classList.add('hide');
                        toast.addEventListener('transitionend', function () {
                            if (toast.parentNode) toast.remove();
                        }, { once: true });
                    }, 3000);
                }

                // ---------- æ¨¡æ€ç¡®è®¤æ¡† ----------
                const modalOverlay = document.getElementById('modalConfirm');
                const modalMessage = document.getElementById('modalMessage');
                let modalResolve = null;
                function showModalConfirm(message = 'æ‚¨ç¡®å®šè¦æ‰§è¡Œæ­¤æ“ä½œå—ï¼Ÿ') {
                    modalMessage.innerText = message;
                    modalOverlay.classList.add('show');
                    return new Promise((resolve) => { modalResolve = resolve; });
                }
                function closeModal() {
                    modalOverlay.classList.remove('show');
                    modalResolve = null;
                }

                // ---------- ç­‰å¾…æ•ˆæœ ----------
                const loadingOverlay = document.getElementById('loadingOverlay');
                function showLoading(duration = 2000) {
                    loadingOverlay.classList.add('show');
                    if (duration > 0) setTimeout(() => loadingOverlay.classList.remove('show'), duration);
                }
                function hideLoading() { loadingOverlay.classList.remove('show'); }

                // ---------- å·¥å…·å‡½æ•°ï¼šæ ¹æ®è¾“å…¥æ¡†è·å–æ­¥è¿›å‚æ•° ----------
                function getStepInfo(inputEl) {
                    if (!inputEl) return { step: 1, min: -Infinity, max: Infinity };
                    let mi = inputEl.getAttribute("min");
                    let ma = inputEl.getAttribute("max");
                    let st = inputEl.getAttribute("step");
                    let min = mi ? parseFloat(mi) : -Infinity;
                    let max = ma ? parseFloat(ma) : Infinity;
                    let step = st ? parseFloat(st) : 1;
                    return { step: step, min: min, max: max };
                }

                // ---------- å…¨å±€äº‹ä»¶å§”æ‰˜ ----------
                function handleDocumentClick(e) {
                    const target = e.target;

                    // ----- æ•°å­—è¾“å…¥ï¼šå¢åŠ  -----
                    if (target.matches('.plus, .inc, .incShapeW, .incShapeH, #widthInc, #fontSizeInc') ||
                        (target.closest && target.closest('.plus'))) {
                        e.preventDefault();
                        let input = null;
                        if (target.id === 'widthInc') input = document.getElementById('widthInput');
                        else if (target.id === 'fontSizeInc') input = document.getElementById('fontSizeInput');
                        else if (target.classList.contains('incShapeW')) input = document.getElementById('shapeWidthInput');
                        else if (target.classList.contains('incShapeH')) input = document.getElementById('shapeHeightInput');
                        else if (target.closest('.editable-stepper')) {
                            input = target.closest('.editable-stepper').querySelector('.stepper-input');
                        }
                        if (input) {
                            const { step, min, max } = getStepInfo(input);
                            let val = parseFloat(input.value) || 0;
                            val = Math.min(max, val + step);
                            val = Math.max(min, val);
                            input.value = val.toFixed(2).replace(/\.00$/, '');
                            // æ˜¾ç¤ºå¯¹åº”æç¤ºæ¶ˆæ¯
                            if (input.id === 'widthInput' || input.id === 'shapeWidthInput' ||
                                input.id === 'shapeHeightInput' || input.id === 'fontSizeInput') {
                                let msg = '';
                                if (input.id === 'widthInput') msg = `å®½åº¦: ${input.value}px`;
                                else if (input.id === 'shapeWidthInput') msg = `å®½åº¦: ${input.value}px`;
                                else if (input.id === 'shapeHeightInput') msg = `é«˜åº¦: ${input.value}px`;
                                else if (input.id === 'fontSizeInput') msg = `å­—å·: ${input.value}pt`;
                                if (msg) showMessage(msg, 'info');
                            }
                        }
                        return;
                    }

                    // ----- æ•°å­—è¾“å…¥ï¼šå‡å°‘ -----
                    if (target.matches('.minus, .dec, .decShapeW, .decShapeH, #widthDec, #fontSizeDec') ||
                        (target.closest && target.closest('.minus'))) {
                        e.preventDefault();
                        let input = null;
                        if (target.id === 'widthDec') input = document.getElementById('widthInput');
                        else if (target.id === 'fontSizeDec') input = document.getElementById('fontSizeInput');
                        else if (target.classList.contains('decShapeW')) input = document.getElementById('shapeWidthInput');
                        else if (target.classList.contains('decShapeH')) input = document.getElementById('shapeHeightInput');
                        else if (target.closest('.editable-stepper')) {
                            input = target.closest('.editable-stepper').querySelector('.stepper-input');
                        }
                        if (input) {
                            const { step, min, max } = getStepInfo(input);
                            let val = parseFloat(input.value) || 0;
                            val = Math.max(min, val - step);
                            val = Math.min(max, val);
                            input.value = val.toFixed(2).replace(/\.00$/, '');
                            if (input.id === 'widthInput' || input.id === 'shapeWidthInput' ||
                                input.id === 'shapeHeightInput' || input.id === 'fontSizeInput') {
                                let msg = '';
                                if (input.id === 'widthInput') msg = `å®½åº¦: ${input.value}px`;
                                else if (input.id === 'shapeWidthInput') msg = `å®½åº¦: ${input.value}px`;
                                else if (input.id === 'shapeHeightInput') msg = `é«˜åº¦: ${input.value}px`;
                                else if (input.id === 'fontSizeInput') msg = `å­—å·: ${input.value}pt`;
                                if (msg) showMessage(msg, 'info');
                            }
                        }
                        return;
                    }

                    // ----- æ¨¡æ€ç¡®è®¤æ¡† -----
                    if (target.id === 'modalCancel' || target.id === 'modalOk' || target === modalOverlay) {
                        if (target.id === 'modalCancel' || target === modalOverlay) {
                            if (modalResolve) modalResolve(false);
                            closeModal();
                            showMessage('å·²å–æ¶ˆæ“ä½œ', 'info');
                        } else if (target.id === 'modalOk') {
                            if (modalResolve) modalResolve(true);
                            closeModal();
                            showMessage('å·²ç¡®è®¤æ“ä½œ', 'success');
                        }
                        return;
                    }

                    // ----- åˆ†æ®µæ§ä»¶ -----
                    if (target.classList.contains('segment-item')) {
                        const parent = target.parentNode;
                        parent.querySelectorAll('.segment-item').forEach(c => c.classList.remove('active'));
                        target.classList.add('active');
                        showMessage(`ç«¯ç‚¹: ${target.innerText}`, 'info');
                        return;
                    }

                    // ----- åŠŸèƒ½æŒ‰é’® -----
                    if (target.id === 'btnApply') { showMessage('âœ” åº”ç”¨å½¢çŠ¶è®¾ç½®æˆåŠŸ', 'success'); return; }
                    if (target.id === 'btnCancel') { showMessage('å–æ¶ˆæ“ä½œ', 'warning'); return; }
                    if (target.id === 'btnTextApply') { showMessage('âœ” æ–‡æœ¬è®¾ç½®å·²åº”ç”¨', 'success'); return; }
                    if (target.id === 'btnTextPreview') { showMessage('ğŸ‘ é¢„è§ˆæ¨¡å¼ (æ¼”ç¤º)', 'info'); return; }
                    if (target.id === 'btnShowSelect') {
                        const single = document.getElementById('singleSelectDemo');
                        const singleVal = single.options[single.selectedIndex]?.text || 'æœªé€‰';
                        const multi = document.getElementById('multiSelectDemo');
                        const selected = Array.from(multi.selectedOptions).map(opt => opt.text).join(', ') || 'æ— ';
                        showMessage(`ä¸‹æ‹‰æ¡†: ${singleVal} | å¤šé€‰: ${selected}`, 'info');
                        return;
                    }
                    if (target.id === 'btnModalConfirm') {
                        showModalConfirm('æ˜¯å¦ä¿å­˜å½“å‰è®¾ç½®ï¼Ÿ').then(result => { if (result) showMessage('è®¾ç½®å·²ä¿å­˜', 'success'); });
                        return;
                    }
                    if (target.id === 'btnLoading') {
                        showLoading(2000);
                        showMessage('ç­‰å¾…æ•ˆæœæ¼”ç¤º (2ç§’åæ¶ˆå¤±)', 'info');
                        return;
                    }

                    // ----- æ°”æ³¡ç¡®è®¤æ¡†ï¼ˆåˆ é™¤æŒ‰é’®ï¼‰-----
                    if (target.id === 'btnDelete') {
                        e.stopPropagation();
                        const existing = document.querySelector('.popconfirm-bubble');
                        if (existing) existing.remove();
                        const bubble = document.createElement('div');
                        bubble.className = 'popconfirm-bubble';
                        bubble.style = 'position:absolute; background:white; border-radius:10px; box-shadow:0 16px 30px rgba(0,0,0,0.2); padding:16px 20px; z-index:2000; display:flex; flex-direction:column; gap:14px; border:1px solid #eaedf0;';
                        const rect = target.getBoundingClientRect();
                        bubble.style.top = rect.top + window.scrollY - 90 + 'px';
                        bubble.style.left = rect.left + window.scrollX + 'px';
                        bubble.innerHTML = `<span style="font-size:14px; font-weight:500;">ç¡®è®¤åˆ é™¤è¯¥é¡¹?</span><div style="display:flex; gap:12px; justify-content:flex-end;"><button id="popYes" style="background:#056de8; border:none; padding:6px 20px; border-radius:10px; color:white; font-size:13px; cursor:pointer;">ç¡®å®š</button><button id="popNo" style="background:white; border:1px solid #ccd2d9; padding:6px 20px; border-radius:10px; font-size:13px; cursor:pointer;">å–æ¶ˆ</button></div>`;
                        document.body.appendChild(bubble);
                        return;
                    }

                    // ----- æ°”æ³¡å†…æŒ‰é’® -----
                    if (target.id === 'popYes' || target.id === 'popNo') {
                        const bubble = target.closest('.popconfirm-bubble');
                        if (bubble) bubble.remove();
                        showMessage(target.id === 'popYes' ? 'å·²åˆ é™¤ (æ¼”ç¤º)' : 'å–æ¶ˆåˆ é™¤', target.id === 'popYes' ? 'error' : 'info');
                        return;
                    }

                    // ----- è‡ªå®šä¹‰ä¸‹æ‹‰æ¡†ï¼šæŒ‰é’®ç‚¹å‡» -----
                    if (target.classList.contains('custom-select-button')) {
                        e.stopPropagation();   // é¿å…è§¦å‘ä¸‹æ–¹çš„å…³é—­é€»è¾‘ï¼ˆä½†ä¿ç•™å†’æ³¡ä»¥ä¾¿å…¨å±€å…³é—­æ£€æµ‹ï¼Œè¿™é‡Œåœæ­¢ä¼ æ’­æ›´å¥½ï¼‰
                        const dropdown = document.getElementById('fontDropdown');
                        if (dropdown) dropdown.classList.toggle('show');
                        return;
                    }

                    // ----- è‡ªå®šä¹‰ä¸‹æ‹‰æ¡†ï¼šé€‰é¡¹ç‚¹å‡» -----
                    if (target.classList.contains('custom-select-option')) {
                        e.stopPropagation();
                        const value = target.dataset.value || target.innerText;
                        const selectedFontSpan = document.getElementById('selectedFont');
                        if (selectedFontSpan) selectedFontSpan.innerText = value;
                        const dropdown = document.getElementById('fontDropdown');
                        if (dropdown) {
                            dropdown.querySelectorAll('.custom-select-option').forEach(o => o.classList.remove('selected'));
                            target.classList.add('selected');
                            dropdown.classList.remove('show');
                        }
                        showMessage(`å­—ä½“è®¾ç½®ä¸º: ${value}`, 'success');
                        return;
                    }

                    // ----- é¢œè‰²å—ç‚¹å‡» -----
                    if (target.classList.contains('swatch')) {
                        showMessage('é¢œè‰²æ‹¾å–å™¨ (æ¼”ç¤º)', 'info');
                        return;
                    }

                    // ---------- å…¨å±€å…³é—­é€»è¾‘ ----------
                    // 1. å…³é—­è‡ªå®šä¹‰ä¸‹æ‹‰æ¡†ï¼ˆç‚¹å‡»å¤–éƒ¨æ—¶ï¼‰
                    const dropdown = document.getElementById('fontDropdown');
                    if (dropdown && dropdown.classList.contains('show')) {
                        if (!target.closest('.custom-select-button') && !target.closest('#fontDropdown')) {
                            dropdown.classList.remove('show');
                        }
                    }
                    // 2. å…³é—­æ°”æ³¡ï¼ˆç‚¹å‡»å¤–éƒ¨æ—¶ï¼‰
                    const bubble = document.querySelector('.popconfirm-bubble');
                    if (bubble && !bubble.contains(target) && target.id !== 'btnDelete') {
                        bubble.remove();
                    }
                }

                function handleDocumentInput(e) {
                    const target = e.target;
                    // æ•°å­—è¾“å…¥æ¡†ï¼šè¿‡æ»¤éæ•°å­—ï¼ˆé’ˆå¯¹ stepper-inputï¼‰
                    if (target.classList.contains('stepper-input')) {
                        target.value = target.value.replace(/[^0-9]/g, '');
                        return;
                    }
                    // æ»‘å—è”åŠ¨
                    if (target.id === 'fillTransparency') {
                        const p = document.getElementById('fillPercent');
                        if (p) p.innerText = target.value + '%';
                        return;
                    }
                    if (target.id === 'lineTransparency') {
                        const p = document.getElementById('linePercent');
                        if (p) p.innerText = target.value + '%';
                        return;
                    }
                    if (target.id === 'blurRange') {
                        const p = document.getElementById('blurPercent');
                        if (p) p.innerText = target.value + 'pt';
                        return;
                    }
                }

                function handleDocumentChange(e) {
                    const target = e.target;
                    // æ•°å­—è¾“å…¥æ¡†ï¼šèŒƒå›´æ ¡éªŒ
                    if (target.classList.contains('stepper-input') ||
                        ['widthInput', 'shapeWidthInput', 'shapeHeightInput', 'fontSizeInput'].includes(target.id)) {
                        const { min, max } = getStepInfo(target);
                        let v = parseFloat(target.value) || 0;
                        if (min !== undefined) v = Math.max(min, v);
                        if (max !== undefined) v = Math.min(max, v);
                        target.value = v;
                        return;
                    }
                    // å•é€‰æŒ‰é’®æç¤º
                    if (target.name === 'fillType' && target.checked) { showMessage(`å¡«å……: ${target.value}`, 'info'); return; }
                    if (target.name === 'lineType' && target.checked) { showMessage(`çº¿æ¡: ${target.value}`, 'info'); return; }
                    // æ»‘å— change æç¤º
                    if (target.id === 'fillTransparency') { showMessage(`å¡«å……é€æ˜åº¦ ${target.value}%`, 'info'); return; }
                    if (target.id === 'lineTransparency') { showMessage(`çº¿æ¡é€æ˜åº¦ ${target.value}%`, 'info'); return; }
                    // ä¸‹æ‹‰æ¡† change æç¤º
                    if (target.id === 'shadowSelect') { showMessage(`é˜´å½±: ${target.value}`, 'warning'); return; }
                    if (target.id === 'compoundType') { showMessage(`å¤åˆç±»å‹: ${target.value}`, 'info'); return; }
                    if (target.id === 'dashType') { showMessage(`çŸ­åˆ’çº¿: ${target.value}`, 'info'); return; }
                    if (target.id === 'rotateInput') { showMessage(`æ—‹è½¬: ${target.value}Â°`, 'info'); return; }
                }

                // ---------- æŒ‚è½½å…¨å±€å§”æ‰˜ ----------
                document.addEventListener('click', handleDocumentClick);
                document.addEventListener('input', handleDocumentInput);
                document.addEventListener('change', handleDocumentChange);

                (function () {
                    /**
                     * åˆå§‹åŒ–æ‰€æœ‰å¸¦æœ‰ data-tooltip çš„å…ƒç´ ï¼ˆæ— å®¹å™¨ç‰ˆï¼‰
                     * @param {string} selector - è§¦å‘å…ƒç´ çš„é€‰æ‹©å™¨ï¼Œé»˜è®¤ '[data-tooltip]'
                     * @param {Object} options - é…ç½®é¡¹
                     * @param {number} options.gap - ä¸è§¦å‘å…ƒç´ çš„é—´è·ï¼Œé»˜è®¤ 10
                     * @param {number} options.duration - åŠ¨ç”»æ—¶é•¿ (ms)ï¼Œé»˜è®¤ 200
                     * @returns {Function} destroy - é”€æ¯å‡½æ•°ï¼Œç”¨äºæ¸…ç†äº‹ä»¶ç›‘å¬å’Œç§»é™¤ tooltip
                     */
                    window.initTooltips = function (selector = '[data-tooltip]', options = {}) {
                        const gap = options.gap ?? 10;
                        const duration = options.duration ?? 200;
                        const elements = Array.from(document.querySelectorAll(selector));
                        if (!elements.length) return () => { };

                        // åˆ›å»ºå…¨å±€å”¯ä¸€çš„ tooltip å…ƒç´ ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
                        let tooltip = document.querySelector('.global-tooltip');
                        if (!tooltip) {
                            tooltip = document.createElement('div');
                            tooltip.className = 'global-tooltip';
                            document.body.appendChild(tooltip);
                        }

                        let hideTimeout = null;       // éšè—åŠ¨ç”»å®šæ—¶å™¨
                        let currentTarget = null;      // å½“å‰è§¦å‘å…ƒç´ 

                        // å¼ºåˆ¶ç«‹å³éšè— tooltipï¼ˆæ— åŠ¨ç”»ï¼‰
                        function forceHide() {
                            if (hideTimeout) {
                                clearTimeout(hideTimeout);
                                hideTimeout = null;
                            }
                            tooltip.classList.remove('show', 'tooltip-above');
                            tooltip.style.display = 'none';
                        }

                        // æ·¡å‡ºéšè—ï¼ˆå¸¦åŠ¨ç”»ï¼‰
                        function fadeOut() {
                            if (hideTimeout) clearTimeout(hideTimeout);
                            tooltip.classList.remove('show');
                            hideTimeout = setTimeout(() => {
                                tooltip.style.display = 'none';
                                hideTimeout = null;
                            }, duration);
                        }

                        // è®¡ç®— tooltip ä½ç½®å¹¶æ˜¾ç¤º
                        function showTooltip(target) {
                            const content = target.getAttribute('data-tooltip');
                            if (!content) return;

                            // å¦‚æœå·²æœ‰éšè—å®šæ—¶å™¨ï¼Œå–æ¶ˆå®ƒ
                            if (hideTimeout) {
                                clearTimeout(hideTimeout);
                                hideTimeout = null;
                            }

                            // è®¾ç½®å†…å®¹
                            tooltip.textContent = content;

                            // ä¸´æ—¶æ˜¾ç¤ºåˆ°å±å¹•å¤–ï¼Œæµ‹é‡å°ºå¯¸ï¼ˆåŒæ—¶ä¿æŒé€æ˜/éšè—çŠ¶æ€ï¼‰
                            tooltip.style.display = 'block';
                            tooltip.style.left = '-9999px';
                            tooltip.style.top = '-9999px';
                            tooltip.classList.remove('show', 'tooltip-above');

                            // è·å– tooltip å®½é«˜
                            const tipW = tooltip.offsetWidth;
                            const tipH = tooltip.offsetHeight;

                            // è§¦å‘å…ƒç´ çš„ä½ç½®ä¿¡æ¯
                            const targetRect = target.getBoundingClientRect();
                            const targetCenterX = targetRect.left + targetRect.width / 2;

                            const vw = window.innerWidth;
                            const vh = window.innerHeight;

                            // é»˜è®¤å°è¯•æ”¾åœ¨ä¸Šæ–¹
                            let left = targetCenterX - tipW / 2;
                            let top = targetRect.top - gap - tipH;
                            let isAbove = true;

                            // ç©ºé—´åˆ¤æ–­
                            const spaceAbove = targetRect.top - gap - tipH;
                            const spaceBelow = vh - (targetRect.bottom + gap) - tipH;

                            if (spaceAbove < 0 && spaceBelow >= 0) {
                                // ä¸Šæ–¹ä¸è¶³ï¼Œä¸‹æ–¹å……è¶³ â†’ åˆ‡æ¢åˆ°ä¸‹æ–¹
                                top = targetRect.bottom + gap;
                                isAbove = false;
                            } else if (spaceAbove < 0 && spaceBelow < 0) {
                                // ä¸Šä¸‹å‡ä¸è¶³ï¼Œå¼ºåˆ¶æ”¾åœ¨ä¸Šæ–¹ï¼ˆåç»­è¾¹ç•Œé™åˆ¶ä¼šå¤„ç†ï¼‰
                                top = targetRect.top - gap - tipH;
                                isAbove = true;
                            }

                            // æ°´å¹³è¾¹ç•Œé™åˆ¶
                            if (left < 0) left = gap;
                            if (left + tipW > vw) left = vw - tipW - gap;

                            // å‚ç›´è¾¹ç•Œé™åˆ¶
                            if (top < 0) top = gap;
                            if (top + tipH > vh) top = vh - tipH - gap;

                            // é‡æ–°ç¡®å®šå®é™…æ–¹å‘ï¼ˆå¯èƒ½è¢«è¾¹ç•Œä¿®æ­£æ”¹å˜ï¼‰
                            if (top + tipH <= targetRect.top + 5) isAbove = true;
                            else if (top >= targetRect.bottom - 5) isAbove = false;
                            else isAbove = (top < targetRect.top);

                            // è®¡ç®—ç®­å¤´åç§»ï¼ˆç›¸å¯¹äº tooltip å·¦è¾¹ç¼˜ï¼‰
                            let arrowLeft = targetCenterX - left;
                            arrowLeft = Math.max(8, Math.min(tipW - 8, arrowLeft)); // é™åˆ¶åœ¨ tooltip å†…éƒ¨

                            // åº”ç”¨æœ€ç»ˆä½ç½®
                            tooltip.style.left = left + 'px';
                            tooltip.style.top = top + 'px';
                            tooltip.style.right = 'auto';
                            tooltip.style.bottom = 'auto';
                            tooltip.style.setProperty('--arrow-left', arrowLeft + 'px');

                            // è®¾ç½®æ–¹å‘ç±»
                            tooltip.classList.toggle('tooltip-above', isAbove);

                            // æ˜¾ç¤ºåŠ¨ç”»
                            requestAnimationFrame(() => {
                                tooltip.classList.add('show');
                            });

                            currentTarget = target;
                        }

                        // é¼ æ ‡ç§»å…¥å¤„ç†
                        function onMouseEnter(e) {
                            const target = e.currentTarget;
                            // å¦‚æœä¹‹å‰æœ‰å…¶ä»–å…ƒç´ çš„ tooltip æ­£åœ¨æ˜¾ç¤ºï¼Œç«‹å³å¼ºåˆ¶éšè—ï¼ˆé˜²é—ªçƒï¼‰
                            if (currentTarget && currentTarget !== target) {
                                forceHide();
                            }
                            showTooltip(target);
                        }

                        // é¼ æ ‡ç§»å‡ºå¤„ç†
                        function onMouseLeave() {
                            fadeOut();
                            currentTarget = null;
                        }

                        // ç»‘å®šäº‹ä»¶
                        elements.forEach(el => {
                            el.addEventListener('mouseenter', onMouseEnter);
                            el.addEventListener('mouseleave', onMouseLeave);
                        });

                        // å…¨å±€äº‹ä»¶ï¼šæ»šåŠ¨/ç¼©æ”¾/ç‚¹å‡»æ—¶éšè— tooltip
                        function onGlobalEvent() {
                            if (currentTarget) {
                                forceHide();
                                currentTarget = null;
                            }
                        }
                        window.addEventListener('scroll', onGlobalEvent, { passive: true });
                        window.addEventListener('resize', onGlobalEvent);
                        document.addEventListener('click', onGlobalEvent);

                        // è¿”å›é”€æ¯å‡½æ•°
                        return function destroy() {
                            elements.forEach(el => {
                                el.removeEventListener('mouseenter', onMouseEnter);
                                el.removeEventListener('mouseleave', onMouseLeave);
                            });
                            window.removeEventListener('scroll', onGlobalEvent);
                            window.removeEventListener('resize', onGlobalEvent);
                            document.removeEventListener('click', onGlobalEvent);
                            if (tooltip && tooltip.parentNode) {
                                tooltip.parentNode.removeChild(tooltip);
                            }
                        };
                    };

                    // è‡ªåŠ¨åˆå§‹åŒ–ï¼ˆä¹Ÿå¯æ‰‹åŠ¨è°ƒç”¨ï¼Œä¾‹å¦‚ initTooltips('.my-selector')ï¼‰
                    initTooltips();
                })();
            }

            // ç¡®ä¿ DOM åŠ è½½å®Œæˆåå†æ‰§è¡Œ
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', init);
            } else {
                init();
            }
        })();
        (function () {
            createTable(document.getElementById("openfileTable"), {
                header: {
                    show: true,
                    title: 'æ–‡æ¡£åˆ—è¡¨',
                    icon: 'ğŸ“„',
                },
                table: {
                    columns: [
                        { field: 'name', header: 'ä»£å·', flex: 1 },
                        { field: 'actions', header: 'æ“ä½œ', flex: 2 }
                    ],
                    rows: [
                        {
                            name: 'R-1',
                            actions: [
                                {
                                    text: 'ğŸ—‘ï¸',
                                    handler: 'delete',
                                    style: 'delete',
                                    title: 'åˆ é™¤æ­¤æ–‡æ¡£'
                                },
                                {
                                    text: 'ğŸ“‚',
                                    handler: 'open',
                                    title: 'æ‰“å¼€æ­¤æ–‡æ¡£'
                                }
                            ]
                        }
                    ]
                }
            });
            createTable(document.getElementById("readOutputTable"), {
                header: {
                    show: true,
                    title: 'ç”Ÿæˆåˆ—è¡¨',
                    icon: 'ğŸ“‹',
                },
                table: {
                    columns: [
                        { field: 'filename', header: 'ğŸ“ƒ', flex: 1 },
                        { field: 'actions', header: 'âš™ï¸', flex: 1, },
                    ],
                    rows: [
                        {
                            filename: 'test.pdf',
                            actions: [
                                {
                                    text: 'ğŸ—‘ï¸',
                                    handler: 'delete',
                                    style: 'delete',
                                    title: 'åˆ é™¤å½“å‰æ–‡ä»¶'
                                },
                                {
                                    text: 'ğŸ‘“',
                                    handler: 'preview',
                                    title: 'é¢„è§ˆå½“å‰æ–‡ä»¶'
                                }
                            ]
                        }
                    ]
                }
            })
            createTable(
                document.getElementById("readfileTable"),
                {
                    header: {
                        show: true,
                        title: 'åˆå¹¶åˆ—è¡¨',
                        icon: 'ğŸ‘¨â€ğŸ’»',
                    },
                    table: {
                        columns: [
                            { field: 'filename', header: 'æ–‡ä»¶å', flex: 1 },
                            { field: 'actions', header: 'æ“ä½œ', flex: 1 },
                        ],
                        rows: [
                            {
                                filename: 'test.pdf',
                                actions: [
                                    {
                                        text: 'ğŸ—‘ï¸',
                                        handler: 'delete',
                                        style: 'delete',
                                        title: "åˆ é™¤æ–‡ä»¶",
                                        callback: (ctx) => {
                                            console.log(ctx);
                                        }
                                    },
                                    {
                                        text: 'ğŸ”',
                                        handler: 'view',
                                        style: 'view',
                                        title: "æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯",
                                    }
                                ]
                            }
                        ]
                    },
                    footer: {
                        show: true,
                        text: (rows) => `ğŸ“Š å…± ${rows.length} ä¸ªæ–‡ä»¶`,
                        class: 'ag-footer-note'
                    },
                    modals: {
                        view: {
                            title: 'æ–‡ä»¶ä¿¡æ¯',
                            subtitle: 'åŸºæœ¬ä¿¡æ¯',
                            fields: [
                                { label: 'æ–‡ä»¶å', field: 'filename' },
                                { label: 'æ–‡ä»¶è·¯å¾„', field: 'path' },
                                { label: 'åˆ›å»ºæ—¥æœŸ', field: 'createtime' },
                                { label: 'ä¿®æ”¹æ—¥æœŸ', field: "modifytime" },
                                { label: 'æ–‡ä»¶å¤§å°', field: "size" }
                            ]
                        }
                    }
                }
            );
        })();
    </script>
</body>

</html>